---
title: "California 2022 Proposition 30"
author: "GitData"
date: "10/21/2022"
output:
  pdf_document:
    toc: yes
    toc_depth: 5
  html_document:
    toc: yes
    toc_depth: '5'
    df_print: paged
---

\clearpage
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library(knitr)
library(ggplot2)
library(dplyr)
library(GGally)
library(lmtest)
library(car)
library(onewaytests)
library(ggiraph)
library(ggiraphExtra)
library(plyr)
library(ggpubr)
```





## 2. Personal Income Tax Data 2020
```{r, include=FALSE}
# Load the 2nd dataset
income = read.csv("https://caelection2022.gitdata.ga/dataset/2020_Combined_AR_PIT_B4A.csv", 
                    header = TRUE)
AGI_class = income$Adjusted.Gross.Income.Class[-c(1, 2, 62, 63)]
People_Taxable = as.numeric(gsub(",","",income$X[-c(1, 2, 62, 63)]))
Federal_AGI = as.numeric(gsub(",","",income$Federal.AGI..Thousands.[-c(1, 2, 62, 63)])) * 1000
Class = c(rep("Lower Class", 42), rep("Middle Class", 7), rep("Upper Class", 10))
income_clean = data.frame(AGI_class, People_Taxable, Federal_AGI, Class)
income_clean[is.na(income_clean)] = 0
```

The second dataset is from the Franchise Tax Board of California, which contains the number of taxpayers in California, and the federal adjusted gross income (AGI), which is the figure that the Internal Revenue Service (IRS) uses to determine your income tax liability for the year, for each AGI class. The original unit for AGI is thousand dollars. In order to make our analysis more accurate, we use dollars as the unit for AGI. This is the data in 2020, which is the latest we can get. 

- `Adjusted.Gross.Income.Class`: The groups of people based on their adjusted gross income (59 counts). 

- `Number.of.Return_Taxable`: The number of people who are eligible to be taxed (11,332,757 counts). 

- `Federal.AGI`: The adjusted gross income, in dollars, of each AGI class. 


After increasing the 1.75% tax for Millionaires, we found there will be 3,843,949,900 dollars that can be applied to our funding for Zero Emission Vehicle (ZEV) program, Wildfire Response, and Prevention Programs, and increasing the charging stations in California. Specifically, 1,729,777,455 dollars to help people buy new electric cars, 1,345,382,465 dollars to build charging stations, 768,789,980 for wildfire prevention. Moreover, the CA state already plans to dedicate 10 billion dollars for the next 5 years to zero-emission vehicle programs and Charging stations. By proportion of the funding to the ZEV program, the CA government should put an additional  2,220,382,465 dollars per year to build new charging stations, and an additional $2,854,777,455 per year to help people buy new electric cars from 2023 to 2027.

```{r, include=FALSE}
# Total people taxable 2020
sum(income_clean$People_Taxable)
# Total AGI 2020
sum(income_clean$Federal_AGI)
# Calculate the tax revenue generated by the 1.75% tax
people_200m = income_clean$Federal_AGI[c(56, 57, 58, 59)]
people_200m
AGI_200m = sum(people_200m)
AGI_200m
tax_revenue = AGI_200m * 0.0175
tax_revenue
```

```{r}
# Amount of money used in each section
buy_car = tax_revenue * 0.45
charging_station = tax_revenue * 0.35
fire_control = tax_revenue * 0.2
# Only for car and charging station in the next 5 years
addition = 10000000000 
addition_car_year = addition / 5 * 0.5625
addition_charging_year = addition / 5 * 0.4375
total_car_2027_year = buy_car + addition_car_year
total_charging_2027_year = charging_station + addition_charging_year
```

```{r}
#2023-2027 charging stations and electric (5years) per year funding
total_car_2027_year = buy_car + addition_car_year
total_charging_2027_year = charging_station + addition_charging_year

#2028-2043 (16 years) charging stations and electric and fire control per year funding
buy_car = tax_revenue * 0.45
charging_station = tax_revenue * 0.35
fire_control = tax_revenue * 0.2
```

## For the number of Charging Stations Prediction 
```{r}
#2023-2027 charging stations (5years) per year # numbers

ave_charging = 115360
number_charging_5year = total_charging_2027_year/115360
number_charging_5year
Total_5year = 5*number_charging_5year
floor(Total_5year)
#2028-2043 (16 years) #number per year
ave_charging = 115360
number_charging_16year = charging_station/115360
number_charging_16year
Total_16year = 16*number_charging_16year
floor(Total_16year)

TOTAL_Plan_Cha =floor(Total_16year) + floor(Total_5year)
TOTAL_Plan_Cha
```
The average cost of one charging station is about 115,360 dollars. From 2023 to 2027 year we will have $2,220,382,465 in funding per year for our charging stations. Thus, there are about 96,237 charging stations that could be built in these 5 years.

From 2028 to the 2043 year, we will have 1,345,382,465 dollars in funding per year for our charging stations. Thus, there are about 186,599 charging stations that could be built in these 16 years.

Thus, before 2043, we will be able to build 282,836 charging stations. 

## For the number of Electric Car Prediction
```{r}
#2023-2027 EC (5years) per year # numbers

ave_car = 65291
number_car_5year = total_car_2027_year/65291
number_car_5year
Total_5_caryear = 5*number_car_5year
floor(Total_5_caryear)
#2028-2043 (16 years) #number per year
ave_car = 65291
number_car_16year = buy_car/65291
number_car_16year
Total_16_caryear = 16*number_car_16year
floor(Total_16_caryear)

TOTAL_Plan_car=floor(Total_16_caryear) + floor(Total_5_caryear)
TOTAL_Plan_car
89712/number_car_5year
```
The average cost of an electric car is about 65,291 dollars. From 2023 to 2027 year we will have 2,854,777,455 dollars in funding per year for our electric car. Thus, there are about 218,619 electric cars that could be built in these 5 years. And 43,723 electric cars can be produced in one year.

From 2028 to the 2043 year, we will have 1,729,777,455 dollars in funding per year for our electric cars. Thus, there are about 423,893 electric cars that could be built in these 16 years.
Thus, before the 2044 year, we will be able to build 642,512 electric cars.

Therefore, in 2026, all passenger cars will be using electricity with zero greenhouse gas emissions.




\clearpage

# Appendix: R Script

```{r, ref.label=knitr::all_labels(),echo=TRUE,eval=FALSE}
```